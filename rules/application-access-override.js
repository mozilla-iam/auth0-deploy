function (user, context, callback) {
  // /!\ DO NOT EDIT THIS FILE /!\
  // Please use http://github.com/mozilla-iam/auth0-rules instead

  // Applications that are restricted
  var MOCO_MOFO_APPS = [
    '0123456789abcdefghijKLMNOPQRSTuv',  // auth : phonebook.mozilla.com
    '123456789abcdefghijKLMNOPQRSTuvw',  // auth-dev : phonebook-dev.mozilla.com
    '23456789abcdefghijKLMNOPQRSTuvwx',  // auth : login.mozilla.com
    '3456789abcdefghijKLMNOPQRSTuvwxy',  // auth-dev : login.mozilla.com
    '456789abcdefghijKLMNOPQRSTuvwxyz',  // auth : passwordreset.mozilla.com
    '56789abcdefghijKLMNOPQRSTuvwxyz0'   // auth-dev : passwordreset.mozilla.com
  ];
  // LDAP groups allowed to access these applications
  var ALLOWED_GROUPS = ['team_moco', 'team_mofo'];

  if (MOCO_MOFO_APPS.indexOf(context.clientID) >= 0) {
    var groupHasAccess = ALLOWED_GROUPS.some(
      function (group) {
        if (!user.groups)
          return false;
        return user.groups.indexOf(group) >= 0;
    });
    if (groupHasAccess) {
     return callback(null, user, context);
    } else {
     context.redirect = {
       url: "https://sso.mozilla.com/forbidden"
     };
     return callback(null, null, context);
    }
  }
  callback(null, user, context);
}
